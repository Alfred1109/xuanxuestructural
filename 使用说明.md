# 玄学预测系统 - 使用说明

## 🚀 快速启动

### 方法一：使用启动脚本（推荐）

```bash
./start.sh
```

这个脚本会自动：
- ✅ 检查并创建虚拟环境
- ✅ 安装所需依赖
- ✅ 启动后端服务器（后台运行）
- ✅ 在浏览器中打开前端页面

### 方法二：手动启动

**启动后端：**
```bash
cd xuanxue-web/backend
venv/bin/python main.py
```

**打开前端：**
```bash
xdg-open xuanxue-web/frontend/index.html
```

## 🛑 停止服务

```bash
./stop.sh
```

或者手动停止：
```bash
# 查看后端进程
ps aux | grep "python main.py"

# 停止进程
kill <PID>
```

## 📍 访问地址

- **前端界面**: `file:///home/alfred/multiproject/xuanxu/xuanxue-web/frontend/index.html`
- **后端API**: http://localhost:8002
- **API文档**: http://localhost:8002/docs （Swagger UI）

## 🎯 功能模块

### 1. 八字命理
- 访问前端主页 `index.html`
- 输入出生信息（年月日时分）
- 查看八字排盘、五行分析、大运流年等

### 2. 六爻占卜
- 访问 `liuyao.html`
- 输入问题，系统自动起卦
- 查看卦象解读和建议

### 3. 奇门遁甲
- 访问 `qimen.html`
- 选择时间和事项类型
- 查看奇门遁甲盘和方位建议

### 4. 择日学
- 访问 `zeri.html`
- 查看今日运势或查找吉日
- 根据用途选择合适的日期

## 🔧 配置说明

### AI增强功能（可选）

系统已安装AI支持包，如需启用AI增强功能，请配置API密钥：

```bash
# 临时设置（当前终端有效）
export ARK_API_KEY=your_api_key_here

# 永久设置（添加到 ~/.bashrc）
echo 'export ARK_API_KEY=your_api_key_here' >> ~/.bashrc
source ~/.bashrc
```

然后重启服务即可使用AI增强功能。

**详细配置指南**: 请查看 [AI配置指南.md](./AI配置指南.md)

**检查AI状态**:
```bash
curl http://localhost:8002/api/ai/status
```

### 修改端口

如果8002端口被占用，可以修改：

编辑 `xuanxue-web/backend/main.py` 最后一行：
```python
uvicorn.run(app, host="0.0.0.0", port=8002)  # 改为其他端口
```

同时修改前端文件中的API地址（在各个HTML文件的JavaScript部分）：
```javascript
const API_BASE_URL = 'http://localhost:8002';  // 改为对应端口
```

## 📊 API接口示例

### 八字排盘
```bash
curl -X POST "http://localhost:8002/api/bazi" \
  -H "Content-Type: application/json" \
  -d '{
    "year": 1990,
    "month": 1,
    "day": 1,
    "hour": 12,
    "minute": 0,
    "gender": "男"
  }'
```

### 六爻占卜
```bash
curl -X POST "http://localhost:8002/api/divination/liuyao?question=今天运势如何"
```

### 查看今日运势
```bash
curl "http://localhost:8002/api/zeri/today"
```

## 📝 日志查看

后端日志保存在：`/tmp/xuanxue-backend.log`

实时查看日志：
```bash
tail -f /tmp/xuanxue-backend.log
```

## ⚠️ 常见问题

### 1. 端口被占用
```bash
# 查看占用8002端口的进程
lsof -i:8002

# 停止该进程
kill <PID>
```

### 2. 前端无法连接后端
- 确保后端服务已启动
- 检查浏览器控制台是否有CORS错误
- 确认API地址是否正确

### 3. 虚拟环境问题
```bash
# 删除旧的虚拟环境
rm -rf xuanxue-web/backend/venv

# 重新运行启动脚本
./start.sh
```

## 📚 项目结构

```
xuanxu/
├── start.sh              # 启动脚本
├── stop.sh               # 停止脚本
├── 使用说明.md           # 本文件
├── README.md             # 项目说明
├── docs/                 # 理论文档
│   ├── 01_根基理论.md
│   ├── 02_命理学.md
│   └── ...
├── site/                 # MkDocs生成的文档站点
└── xuanxue-web/          # Web应用
    ├── backend/          # Python后端
    │   ├── main.py       # FastAPI主程序
    │   ├── core/         # 核心算法
    │   └── venv/         # 虚拟环境
    └── frontend/         # 前端页面
        ├── index.html    # 八字命理
        ├── liuyao.html   # 六爻占卜
        ├── qimen.html    # 奇门遁甲
        └── zeri.html     # 择日学
```

## 🎓 学习资源

查看 `docs/` 目录下的理论文档，了解：
- 阴阳五行基础理论
- 八字命理详解
- 六爻占卜方法
- 奇门遁甲原理
- 择日学知识

## ⚖️ 免责声明

本系统仅供学习、研究和娱乐使用，不应作为人生重大决策的唯一依据。命运掌握在自己手中，积极努力才是改变人生的关键。
